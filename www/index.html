<!DOCTYPE html>
<html>
  <head>
    <title>Capture Photo</title>
    <meta name="viewport" content="width=device-width,height=device-height,initial-scale=1"/>
    <script src="phonegap.js"></script>
	<script src="http://code.jquery.com/jquery-latest.min.js" type="text/javascript"></script> 
	<script type="text/javascript" charset="utf-8">
    var sPicData; //store image data for image upload functionality

    function capturePhoto(){
        navigator.camera.getPicture(picOnSuccess, picOnFailure, { 
            quality: 20,
            destinationType: Camera.DestinationType.DATA_URL,
            sourceType: Camera.PictureSourceType.CAMERA,
            correctOrientation: true
        });
    }

    function getPhoto(){
        navigator.camera.getPicture(picOnSuccess, picOnFailure, { 
            quality: 20,
            destinationType: Camera.DestinationType.DATA_URL,
            sourceType: Camera.PictureSourceType.SAVEDPHOTOALBUM,
            correctOrientation: true
        });
    }

    function picOnSuccess(imageData){
			alert('picOnSuccess 1');
			alert(imageData);
            var image = document.getElementById('cameraPic');
            image.src = imageData;
			image.style.display = 'block';
            sPicData  = imageData; //store image data in a variable
    }

    function picOnFailure(message){
        alert('Failed because: ' + message);
    }

    // ----- upload image ------------
    function photoUpload() {
	    alert('photoUpload -1');
        var options = new FileUploadOptions();
        options.fileKey = "file";
        options.fileName = sPicData.substr(sPicData.lastIndexOf('/') + 1);
        options.mimeType = "image/jpeg";
        options.chunkedMode = false;
        var params = new Object();
        params.fileKey = "file";
        options.params = {}; // eig = params, if we need to send parameters to the server request
        ft = new FileTransfer();
        ft.upload(sPicData, "http://issolutions.esy.es/php/upload.php", win, fail, options);
        alert('photoUpload -2');		
    }

    function win(){
        alert("image uploaded scuccesfuly");
    }

    function fail(){
        alert("image upload has been failed");
    }

  </script>
  </head>
  <body>
	<div id="camera">
		<button class="camera-control" onclick="capturePhoto();">Foto </button>
		<button class="camera-control" onclick="getPhoto();">From Photo Library</button><br>
		<div style="text-align:center;margin:20px;">
			<img id="cameraPic" src="" style="display:none;width:auto;height:120px;"></img>
		</div>
		<button class="camera-control" onclick="photoUpload();">UPLOAD</button>
	</div>
  </body>
</html>
